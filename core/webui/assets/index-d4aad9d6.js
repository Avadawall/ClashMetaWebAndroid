import{s as Be,a as He,m as Ge,i as u,c as l,S as T,b as _,t as y,d as M,e as X,f as Y,g as I,h as B,j as $,k as g,l as Oe,n as We,r as Ve,o as Xe,p as F,u as Se,q as G,v as le,w as O,x as ie,y as Ze,z as Je,A as D,B as Qe,I as Ee,F as Q,C as ce,D as Z,E as Ke,G as Ye,H as et,J as tt,K as nt,L as st,M as at,N as rt,O as ot,P as lt,Q as it,R as ct,T as de,U as dt,V as pe,W as ut,X as pt,Y as gt,Z as k,_ as ft,$ as mt,a0 as A,a1 as ht,a2 as vt,a3 as yt,a4 as bt,a5 as xt}from"./vendor-5f1229f9.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const wt="modulepreload",$t=function(e,t){return new URL(e,t).href},ge={},R=function(t,r,a){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=$t(s,a),s in ge)return;ge[s]=!0;const o=s.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(!!a)for(let f=n.length-1;f>=0;f--){const p=n[f];if(p.href===s&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${i}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":wt,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((f,p)=>{c.addEventListener("load",f),c.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Ct=y('<div class="loading loading-spinner">'),Pt=y('<button><span class="truncate rounded-none">'),ee=e=>{const[t,r]=Be(e,["class","loading","icon"]);return(()=>{const a=Pt(),n=a.firstChild;return He(a,Ge({get class(){return M("btn flex items-center",t.loading?"btn-disabled":t.class)}},r),!1,!0),u(a,l(T,{get when(){return t.loading},get children(){return Ct()}}),n),u(n,()=>e.icon||e.children),_(()=>n.classList.toggle("flex-1",!t.icon)),a})()},Tt=y('<div><div class="collapse-title pr-4 text-xl font-medium after:!top-8"></div><div>'),hs=e=>{const{title:t,onCollapse:r}=e,a=()=>{const s="collapse-open",o="collapse-close";return e.isOpen?s:o},n=()=>{const s="opacity-100",o="opacity-0";return e.isOpen?s:o};return(()=>{const s=Tt(),o=s.firstChild,i=o.nextSibling;return o.$$click=()=>r(!e.isOpen),u(o,t),u(i,l(T,{get when(){return e.isOpen},get children(){return Y(()=>e.children)()}})),_(d=>{const c=M(a(),"collapse collapse-arrow select-none border-secondary bg-base-200 shadow-md"),f=M(n(),"collapse-content grid grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5");return c!==d._v$&&I(s,d._v$=c),f!==d._v$2&&I(i,d._v$2=f),d},{_v$:void 0,_v$2:void 0}),s})()};X(["click"]);const St=y('<div class="py-2 text-center text-lg font-semibold">'),fe=e=>(()=>{const t=St();return u(t,Y(()=>e.children)),_(()=>t.classList.toggle("divider",!!e.withDivider)),t})(),_t=["light","dark","cupcake","bumblebee","emerald","corporate","synthwave","retro","cyberpunk","valentine","halloween","garden","forest","aqua","lofi","pastel","fantasy","wireframe","black","luxury","dracula","cmyk","autumn","business","acid","lemonade","night","coffee","winter"];var C=(e=>(e.Overview="/overview",e.Proxies="/proxies",e.Rules="/rules",e.Conns="/conns",e.Log="/logs",e.Config="/config",e.Setup="/setup",e.Transition="/transition",e))(C||{});const ne=10,me={title:{align:"center",style:{color:"gray",fontSize:"16px"}},chart:{toolbar:{show:!1},zoom:{enabled:!1},animations:{easing:"linear"}},noData:{text:"Loading..."},legend:{showForSingleSeries:!0,fontSize:"16px",labels:{colors:"gray"},itemMargin:{horizontal:32}},dataLabels:{enabled:!1},grid:{yaxis:{lines:{show:!1}}},stroke:{curve:"smooth"},tooltip:{enabled:!1},xaxis:{range:ne,labels:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:"gray",fontSize:"13px"},formatter:e=>B(e).toString()}}};var ue=(e=>(e[e.NOT_CONNECTED=-1]="NOT_CONNECTED",e[e.MEDIUM=200]="MEDIUM",e[e.HIGH=500]="HIGH",e))(ue||{}),_e=(e=>(e[e.NOT_CONNECTED=-1]="NOT_CONNECTED",e[e.MEDIUM=800]="MEDIUM",e[e.HIGH=1500]="HIGH",e))(_e||{}),Le=(e=>(e.OFF="off",e.DOTS="dots",e.BAR="bar",e.Auto="auto",e))(Le||{}),q=(e=>(e.NATURAL="orderNatural",e.LATENCY_ASC="orderLatency_asc",e.LATENCY_DESC="orderLatency_desc",e.NAME_ASC="orderName_asc",e.NAME_DESC="orderName_desc",e))(q||{}),E=(e=>(e.EN="en-US",e.ZH="zh-CN",e))(E||{}),De=(e=>(e.Details="details",e.Close="close",e.ID="ID",e.Type="type",e.Process="process",e.Host="host",e.SniffHost="sniffHost",e.Rule="rules",e.Chains="chains",e.DlSpeed="dlSpeed",e.ULSpeed="ulSpeed",e.Download="dl",e.Upload="ul",e.ConnectTime="connectTime",e.SourceIP="sourceIP",e.SourcePort="sourcePort",e.Destination="destination",e))(De||{});const he=200,ke=Object.values(De),Lt={...Object.fromEntries(ke.map(e=>[e,!0])),ID:!1};var j=(e=>(e.XS="xs",e.SM="sm",e.MD="md",e.LG="lg",e))(j||{}),Dt=(e=>(e.Global="global",e.Rule="rule",e.Direct="direct",e))(Dt||{}),Me=(e=>(e.Info="info",e.Error="error",e.Warning="warning",e.Debug="debug",e.Silent="silent",e))(Me||{});const kt=[200,300,500,800,1e3],Mt=kt[0];var P=(e=>(e[e.File=0]="File",e[e.Url=1]="Url",e[e.AddNew=2]="AddNew",e[e.Board=3]="Board",e))(P||{});const Nt={add:"Add",overview:"Overview",proxies:"Proxies",proxiesSettings:"Proxies Settings",rules:"Rules",connections:"Connections",connectionsSettings:"Connections Settings",connectionsDetails:"Connections Details",logs:"Logs",logsSettings:"Logs Settings",config:"Config",upload:"Upload",download:"Download",uploadTotal:"Upload Total",downloadTotal:"Download Total",activeConnections:"Active Connections",memoryUsage:"Memory Usage",traffic:"Traffic",memory:"Memory",down:"Down",up:"Up",proxyProviders:"Proxy Providers",ruleProviders:"Rule Providers",search:"Search",ID:"ID",type:"Type",name:"Name",process:"Process",host:"Host",sniffHost:"Sniff Host",chains:"Chains",connectTime:"Time",dlSpeed:"DL Speed",ulSpeed:"UL Speed",dl:"DL",ul:"UL",sourceIP:"Source IP",sourcePort:"Source Port",destination:"Destination",close:"Close",reset:"Reset",dnsQuery:"DNS Query",dots:"Dots",bar:"Bar",auto:"Auto",off:"Off",proxiesPreviewType:"Proxies preview type",urlForLatencyTest:"URL for latency test",autoCloseConns:"Automatically Close connections",useTwemoji:"Use Twemoji Mozilla Font",autoSwitchTheme:"Automatically switch theme",favDayTheme:"Favorite light theme",favNightTheme:"Favorite dark theme",renderInTwoColumns:"Render in two columns",updateGEODatabases:"Update GEO Databases",restartCore:"Restart Core",upgradeCore:"Upgrade Core",proxiesSorting:"Proxies Sorting",orderNatural:"Original order in config file",orderLatency_asc:"By latency from low to high",orderLatency_desc:"By latency from high to low",orderName_asc:"By name alphabetically (A-Z)",orderName_desc:"By name alphabetically (Z-A)",ms:"ms",updated:"Updated",tableSize:"Table size",logLevel:"Log Level",info:"info",silent:"silent",debug:"debug",warning:"warning",error:"error",logMaxRows:"Log Maximum Reserved Rows",xs:"Extra small size",sm:"Small size",md:"Normal size",lg:"Large size",switchEndpoint:"Switch Endpoint",switchLanguage:"Switch Language",latencyTestTimeoutDuration:"Latency Test Timeout Duration",all:"All",sequence:"Sequence",payload:"Payload",details:"Details",endpointURL:"Endpoint URL",secret:"Secret",global:"Global",rule:"Rule",direct:"Direct",active:"Active",closed:"Closed",sort:"Sort",hideUnAvailableProxies:"Hide UnAvailable Proxies",reloadConfig:"Reload Config",flushFakeIP:"Flush Fake-IP",tagClientSourceIPWithName:"Tag Client Source IP With Name",tag:"Tag",coreConfig:"Core Config",xdConfig:"XD Config",version:"Version",expire:"Expire",noExpire:"Null",enableTunDevice:"Enable TUN Device",tunModeStack:"TUN Mode Stack",tunDeviceName:"TUN Device Name",interfaceName:"Interface Name",en:"English",zh:"Chinese",port:"{{ name }} Port",onlyHttpContent:"Only for http(s) and content protocol",disabled:"Disabled",interval:"Interval(Mins)",profileURL:"Profile URL",profileFile:"Profile File",submit:"Submit",profileSuccess:"Upload profile successfully",downloadProfile:"Download current profile"},Ut={add:"添加",overview:"概览",proxies:"代理",proxiesSettings:"代理设置",rules:"规则",connections:"连接",connectionsSettings:"连接设置",connectionsDetails:"连接详情",logs:"日志",logsSettings:"日志设置",config:"配置",upload:"上传",download:"下载",uploadTotal:"上传总量",downloadTotal:"下载总量",activeConnections:"活动连接",memoryUsage:"内存使用情况",traffic:"流量",memory:"内存",down:"下载",up:"上传",proxyProviders:"代理提供者",ruleProviders:"规则提供者",search:"搜索",ID:"ID",type:"类型",name:"名字",process:"进程",host:"主机",sniffHost:"嗅探域名",chains:"链路",connectTime:"连接时间",dlSpeed:"下载速度",ulSpeed:"上传速度",dl:"下载量",ul:"上传量",sourceIP:"源地址",sourcePort:"源端口",destination:"目标地址",close:"关闭",reset:"重置",dnsQuery:"DNS 查询",dots:"点阵",bar:"条形",auto:"自适应",off:"关闭",proxiesPreviewType:"节点组预览样式",urlForLatencyTest:"测速链接",autoCloseConns:"自动断开连接",useTwemoji:"使用 Twemoji Mozilla 字体",autoSwitchTheme:"自动切换主题",favDayTheme:"浅色主题偏好",favNightTheme:"深色主题偏好",renderInTwoColumns:"双列渲染",updateGEODatabases:"更新 GEO 数据库",restartCore:"重启核心",upgradeCore:"更新核心",proxiesSorting:"节点排序",orderNatural:"原配置文件中的排序",orderLatency_asc:"按延迟从低到高",orderLatency_desc:"按延迟从高到低",orderName_asc:"按名称字母排序 (A-Z)",orderName_desc:"按名称字母排序 (Z-A)",ms:"毫秒",updated:"更新于",tableSize:"表格大小",logLevel:"日志等级",info:"信息",silent:"静默",debug:"调试",warning:"警告",error:"错误",logMaxRows:"日志最大保留行数",xs:"超小尺寸",sm:"小尺寸",md:"正常尺寸",lg:"超大尺寸",switchEndpoint:"切换后端",switchLanguage:"切换语言",latencyTestTimeoutDuration:"测速超时时间",all:"全部",sequence:"序列号",payload:"内容",details:"详情",endpointURL:"后端地址",secret:"密钥",global:"全局",rule:"规则",direct:"直连",active:"活动",closed:"已关闭",sort:"排序",hideUnAvailableProxies:"隐藏不可用节点",reloadConfig:"重载配置",flushFakeIP:"清空 Fake-IP",tagClientSourceIPWithName:"为客户端源 IP 地址添加名称标记",tag:"标记",coreConfig:"核心配置",xdConfig:"XD 配置",version:"版本",expire:"到期时间",noExpire:"不限时",enableTunDevice:"开启 TUN 转发",tunModeStack:"TUN 模式堆栈",tunDeviceName:"TUN 设备名称",interfaceName:"接口名称",en:"英文",zh:"中文",port:"{{ name }} 端口",onlyHttpContent:"仅接受http(s)和content类型",disabled:"已禁用",interval:"更新间隔(Mins)",profileURL:"配置URL输入",profileFile:"配置文件上传",submit:"提交",profileSuccess:"profile成功上传",downloadProfile:"下载当前profile"},Ne={[E.EN]:Nt,[E.ZH]:Ut},[It,vs]=$(g(Reflect.has(Ne,navigator.language)?navigator.language:E.EN),{name:"lang",storage:localStorage}),[qt,jt]=Oe(e=>[We(()=>Xe(Ne[e.locale]),Ve)]),W=()=>jt(),[ys,bs]=$(g(Le.Auto),{name:"proxiesPreviewType",storage:localStorage}),[xs,ws]=$(g(q.NATURAL),{name:"proxiesOrderingType",storage:localStorage}),[$s,Cs]=$(g(!1),{name:"hideUnAvailableProxies",storage:localStorage}),[se,Ps]=$(g("https://www.gstatic.com/generate_204"),{name:"urlForLatencyTest",storage:localStorage}),[Ft,Ts]=$(g(!1),{name:"autoCloseConns",storage:localStorage}),[At,Ss]=$(g(!0),{name:"useTwemoji",storage:localStorage}),[Rt,_s]=$(g(!1),{name:"autoSwitchTheme",storage:localStorage}),[zt,Ls]=$(g("lofi"),{name:"favDayTheme",storage:localStorage}),[Bt,Ds]=$(g("business"),{name:"favNightTheme",storage:localStorage}),[ks,Ms]=$(g(j.XS),{name:"connectionsTableSize",storage:localStorage}),[Ns,Us]=$(g(Lt),{name:"connectionsTableColumnVisibility",storage:localStorage}),[Is,qs]=$(g(ke),{name:"connectionsTableColumnOrder",storage:localStorage}),[js,Fs]=$(g([]),{name:"clientSourceIPTags",storage:localStorage}),[As,Rs]=$(g(j.XS),{name:"logsTableSize",storage:localStorage}),[zs,Bs]=$(g(Me.Info),{name:"logLevel",storage:localStorage}),[Hs,Gs]=$(g(Mt),{name:"logMaxRows",storage:localStorage}),Os=e=>{let t="table-xs";switch(e){case j.XS:t="table-xs";break;case j.SM:t="table-sm";break;case j.MD:t="table-md";break;case j.LG:t="table-lg";break}return t},[ve,Ws]=$(g(5e3),{name:"latencyTestTimeoutDuration",storage:localStorage}),Ht=()=>se().startsWith("https"),U=()=>Ht()?_e:ue,[Gt,Ue]=g([]),[V,Ot]=g(null),Vs=()=>{const[e,t]=g([]),[r,a]=g([]),[n,s]=g(!1);return F(()=>{var i;const o=(i=V())==null?void 0:i.connections;o&&Se(()=>{const d=Ie(o,r());if(Wt(r()),!n()){const c=Vt(d,Gt());a(d),t(c.slice(-he))}Ue(c=>c.slice(-(d.length+he)))})}),{closedConnections:e,activeConnections:r,paused:n,setPaused:s}},Ie=(e,t)=>{const r=new Map;return t.forEach(a=>r.set(a.id,a)),e.map(a=>{const n=r.get(a.id);return!n||!G.isNumber(n.download)||!G.isNumber(n.upload)?{...a,downloadSpeed:0,uploadSpeed:0}:{...a,downloadSpeed:a.download-n.download,uploadSpeed:a.upload-n.upload}})},Wt=e=>{Ue(t=>G.unionWith(t,e,(r,a)=>r.id===a.id))},Vt=(e,t)=>G.differenceWith(t,e,(r,a)=>r.id===a.id),Xs=()=>x().delete("connections"),Xt=e=>x().delete(`connections/${e}`),[Zs,ye]=g(!1),[Js,be]=g(!1),[Qs,xe]=g(!1),[Es,we]=g(!1),[Ks,$e]=g(!1),Ys=async()=>{const e=x();ye(!0);try{await e.put("configs",{searchParams:{force:!0},json:{path:"",payload:""}})}catch{}ye(!1)},ea=async()=>{const e=x();xe(!0);try{await e.post("cache/fakeip/flush")}catch{}xe(!1)},ta=async()=>{const e=x();be(!0);try{await e.post("configs/geo")}catch{}be(!1)},na=async()=>{const e=x();we(!0);try{await e.post("upgrade")}catch{}we(!1)},sa=async()=>{const e=x();$e(!0);try{await e.post("restart")}catch{}$e(!1)},aa=()=>x().get("configs").json(),ra=async(e,t,r)=>{try{await x().patch("configs",{json:{[e]:t}}).json(),await r()}catch(a){le.error(a.message)}},oa=async()=>{const e=x(),{version:t}=await e.get("version").json();return t},Zt=()=>x().get("providers/proxies").json(),Jt=()=>x().get("proxies").json(),Ce=e=>x().put(`providers/proxies/${e}`),qe=e=>x().get(`providers/proxies/${e}/healthcheck`,{timeout:5*1e3}).json(),Qt=(e,t)=>x().put(`proxies/${e}`,{body:JSON.stringify({name:t})}),Et=(e,t,r,a)=>{const n=x();return t!==""?qe(t).then(s=>({delay:s[e]})):n.get(`proxies/${e}/delay`,{searchParams:{url:r,timeout:a}}).json()},Kt=(e,t,r)=>x().get(`group/${e}/delay`,{searchParams:{url:t,timeout:r}}).json(),la=()=>x().get("rules").json(),ia=()=>x().get("providers/rules").json(),ca=e=>x().put(`providers/rules/${e}`),da=async e=>{const t=/(alpha|beta|meta)-?(\w+)/.exec(e);if(!t)return!1;const r=t[1],a=t[2];if(r==="meta"){const{assets:n}=await O.get("https://api.github.com/repos/MetaCubeX/Clash.Meta/releases/latest").json();return!n.some(({name:o})=>o.includes(a))}if(r==="alpha"){const{assets:n}=await O.get("https://api.github.com/repos/MetaCubeX/Clash.Meta/releases/tags/Prerelease-Alpha").json();return!n.some(({name:o})=>o.includes(a))}return!1},Yt=async()=>{const e=x(),{mode:t}=await e.get("version").json();return t},en=async()=>await x().get("primitive").json(),ua=e=>/^https?/.test(e)?e:`${window.location.protocol}//${e}`,J=()=>{const[e,t]=g({}),r=(n,s)=>{t({...e(),[n]:s})};return{map:e,set:r,setWithCallback:async(n,s)=>{r(n,!0);try{await s()}catch{}r(n,!1)}}},tn=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return new TextDecoder("utf-8").decode(r)},nn=(e="")=>{const t=e.toLowerCase();return t.includes("shadowsocks")?t.replace("shadowsocks","ss"):t==="hysteria"?"hy":t==="wireguard"?"wg":t},sn=(e="")=>{const t=e.toLowerCase();return!["selector","direct","reject","urltest","loadbalance","fallback","relay"].includes(t)},pa=(e,t,r)=>r===q.NATURAL?e:e.sort((a,n)=>{const s=t[a],o=t[n];switch(r){case q.LATENCY_ASC:return s===U().NOT_CONNECTED?1:o===U().NOT_CONNECTED?-1:s-o;case q.LATENCY_DESC:return s===U().NOT_CONNECTED?1:o===U().NOT_CONNECTED?-1:o-s;case q.NAME_ASC:return a.localeCompare(n);case q.NAME_DESC:return n.localeCompare(a);default:return 0}}),ga=(e,t,r)=>r?e.filter(a=>t[a]!==U().NOT_CONNECTED):e,{map:an,set:rn}=J(),{map:on,setWithCallback:ln}=J(),{map:cn,setWithCallback:dn}=J(),{map:un,setWithCallback:pn}=J(),{map:gn,setWithCallback:fn}=J(),[mn,Pe]=g(!1),[hn,vn]=g([]),[Te,yn]=g([]),[je,ae]=g({}),[Fe,bn]=g({}),xn=e=>{const t={...Fe()},r={...je()};e.forEach(a=>{var p;const{udp:n,xudp:s,type:o,now:i,name:d,provider:c=""}=a,f=((p=a.history.at(-1))==null?void 0:p.delay)||U().NOT_CONNECTED;t[a.name]={udp:n,xudp:s,type:o,now:i,name:d,provider:c},r[a.name]=f}),ie(()=>{bn(t),ae(r)})},re=()=>{const e=async()=>{const[{providers:i},{proxies:d}]=await Promise.all([Zt(),Jt()]),c=[...d.GLOBAL.all??[],"GLOBAL"],f=Object.values(d).filter(v=>{var w;return(w=v.all)==null?void 0:w.length}).sort((v,w)=>c.indexOf(v.name)-c.indexOf(w.name)),p=Object.values(i).filter(v=>v.name!=="default"&&v.vehicleType!=="Compatible"),m=[...Object.values(d),...p.flatMap(v=>v.proxies.filter(w=>!(w.name in d)).map(w=>({...w,provider:v.name})))];ie(()=>{vn(f),yn(p),xn(m)})};return{collapsedMap:an,setCollapsedMap:rn,proxyLatencyTestingMap:on,proxyGroupLatencyTestingMap:cn,proxyProviderLatencyTestingMap:un,updatingMap:gn,isAllProviderUpdating:mn,proxies:hn,proxyProviders:Te,proxyLatencyTest:(i,d)=>ln(i,async()=>{const{delay:c}=await Et(i,d,se(),ve());ae(f=>({...f,[i]:c}))}),proxyGroupLatencyTest:i=>dn(i,async()=>{const d=await Kt(i,se(),ve());ae(c=>({...c,...d})),await e()}),latencyMap:je,proxyNodeMap:Fe,fetchProxies:e,selectProxyInGroup:async(i,d)=>{await Qt(i.name,d),await e(),Ft()&&Se(()=>{var f;const c=Ie(((f=V())==null?void 0:f.connections)??[],[]);c.length>0&&c.forEach(({id:p,chains:m})=>{m.includes(i.name)&&Xt(p)})})},updateProviderByProviderName:i=>fn(i,async()=>{try{await Ce(i)}catch{}await e()}),updateAllProvider:async()=>{Pe(!0);try{await Promise.allSettled(Te().map(i=>Ce(i.name))),await e()}finally{Pe(!1)}},proxyProviderLatencyTest:i=>pn(i,async()=>{await qe(i),await e()})}},[wn,fa]=$(g(""),{name:"selectedEndpoint",storage:localStorage}),[$n,ma]=$(g([]),{name:"endpointList",storage:localStorage}),x=()=>{const e=N();if(!e)return O.create({});const t=new Headers;return e.secret&&t.set("Authorization",`Bearer ${e.secret}`),O.create({prefixUrl:e.url,headers:t})},Cn=()=>{const e=N();if(!e)return O.create({});const t=new Headers;return e.secret&&t.set("Authorization",`Bearer ${e.secret}`),O.create({prefixUrl:e.url,headers:t,hooks:{beforeError:[async r=>{const{response:a}=r;if(a.status===400&&a.body){const n=await a.json();le.error("error:"+n.message)}return r}]}})},N=()=>$n().find(({id:e})=>e===wn()),Pn=()=>{var e;return(e=N())==null?void 0:e.secret},Tn=()=>{var e;return new URL(((e=N())==null?void 0:e.url)??"").origin.replace("http","ws")},oe=(e,t={})=>{const r=new URLSearchParams(t);r.set("token",Pn()??"");const a=Ze(`${Tn()}/${e}?${r.toString()}`),n=Je(a,"message");return D(()=>{var o;return n()?JSON.parse((o=n())==null?void 0:o.data):null})},[Sn,Ae]=$(g("halloween"),{name:"theme",storage:localStorage}),_n={uuid:"",name:"",pType:3,interval:0,source:"",payload:""},[K,Ln]=g(P.Board),[S,Re]=g(_n),H=(e,t)=>{Re({...S(),[e]:t})},Dn=y('<li class="tooltip tooltip-bottom">'),kn=y('<div class="drawer drawer-end w-auto sm:ml-auto"><input id="themes" type="checkbox" class="drawer-toggle"><div class="drawer-content flex items-center"><label for="themes" class="btn btn-circle btn-primary drawer-button btn-sm"></label></div><div class="drawer-side"><label for="themes" class="drawer-overlay"></label><ul class="menu rounded-l-box gap-2 bg-base-300 p-2">'),Mn=y('<li class="btn btn-xs">'),Nn=y('<div class="drawer w-auto lg:hidden"><input id="navs" type="checkbox" class="drawer-toggle"><div class="drawer-content flex items-center"><label for="navs" class="btn btn-circle drawer-button btn-sm"></label></div><div class="drawer-side"><label for="navs" class="drawer-overlay"></label><ul class="menu rounded-r-box min-h-full w-2/5 gap-2 bg-base-300 pt-20">'),Un=y('<div class="navbar-center hidden lg:flex"><ul class="menu menu-horizontal menu-lg gap-2 p-0">'),In=y('<ul class="navbar sticky inset-x-0 top-0 z-50 flex w-auto items-center justify-center bg-base-300 px-4 shadow-lg"><div class="navbar-start gap-4"></div><div class="navbar-end"><div class="flex items-center gap-2">'),qn=y("<li>"),jn=({href:e,tooltip:t,children:r})=>(()=>{const a=Dn();return Z(a,"data-tip",t),u(a,l(ce,{class:"rounded-box",href:e,children:r})),a})(),Fn=()=>(()=>{const e=kn(),t=e.firstChild,r=t.nextSibling,a=r.firstChild,n=r.nextSibling,s=n.firstChild,o=s.nextSibling;return u(a,l(Ke,{})),u(o,l(Q,{each:_t,children:i=>(()=>{const d=Mn();return d.$$click=()=>Ae(i),Z(d,"data-theme",i),u(d,i),d})()})),e})(),An=()=>{const[e]=W(),t=()=>[{href:C.Overview,name:e("overview"),icon:l(Ye,{})},{href:C.Proxies,name:e("proxies"),icon:l(et,{})},{href:C.Rules,name:e("rules"),icon:l(tt,{})},{href:C.Conns,name:e("connections"),icon:l(nt,{})},{href:C.Log,name:e("logs"),icon:l(st,{})},{href:C.Config,name:e("config"),icon:l(at,{})}],r=Qe(),[a,n]=g(!1);return(()=>{const s=In(),o=s.firstChild,i=o.nextSibling,d=i.firstChild;return u(o,l(T,{get when(){return K()==P.Board},get children(){const c=Nn(),f=c.firstChild,p=f.nextSibling,m=p.firstChild,v=p.nextSibling,w=v.firstChild,b=w.nextSibling;return f.addEventListener("change",h=>n(h.target.checked)),u(m,l(Ee,{})),u(b,l(Q,{get each(){return t()},children:({href:h,name:L})=>(()=>{const te=qn();return te.$$click=()=>n(!1),u(te,l(ce,{href:h,children:L})),te})()})),_(()=>f.checked=a()),c}}),null),u(o,l(Hn,{}),null),u(s,l(T,{get when(){return r.pathname!==C.Setup},get children(){const c=Un(),f=c.firstChild;return u(f,l(T,{get when(){return K()==P.Board},get children(){return l(Q,{get each(){return t()},children:({href:p,name:m,icon:v})=>l(jn,{href:p,tooltip:m,children:v})})}})),c}}),i),u(d,l(Fn,{})),s})()};X(["click"]);const Rn=y("<span>"),zn=e=>{const[t]=W(),{latencyMap:r}=re(),[a,n]=g(""),s=D(()=>r()[e.name]);return F(()=>{n("text-success"),s()>U().HIGH?n("text-error"):s()>U().MEDIUM&&n("text-warning")}),l(T,{get when(){return D(()=>typeof s()=="number")()&&s()!==ue.NOT_CONNECTED},get children(){const o=Rn();return u(o,s,null),u(o,()=>t("ms"),null),_(()=>I(o,`whitespace-nowrap text-xs ${a()}`)),o}})},Bn=y('<div class="text-md flex items-center gap-1 whitespace-nowrap font-bold uppercase sm:text-xl"><span>(</span><a class="text-primary transition-transform hover:rotate-90 hover:scale-125" href="https://github.com/metacubex/metacubexd" target="_blank">xd</a><span>)'),Hn=()=>(()=>{const e=Bn(),t=e.firstChild;return u(e,l(ce,{class:"bg-gradient-to-br from-primary to-secondary bg-clip-text text-transparent",get href(){return N()?"/":"/setup"},children:"metacube"}),t),e})(),Gn=y('<div class="sticky bottom-0 z-50 flex items-center justify-end bg-base-100 bg-opacity-80 p-4 backdrop-blur"><div class="flex justify-end gap-2">'),On=y('<dialog class="modal modal-bottom sm:modal-middle"><div class="modal-box p-0"><div><div class="flex items-center gap-4 text-xl font-bold"><span></span></div></div><div class="p-4"></div></div><form method="dialog" class="modal-backdrop"><button>'),Wn="sticky bottom-0 z-50 flex items-center justify-end bg-base-100 bg-opacity-80 p-4 backdrop-blur",ha=e=>{let t;return(()=>{const r=On(),a=r.firstChild,n=a.firstChild,s=n.firstChild,o=s.firstChild,i=n.nextSibling;return rt(d=>{var c;return(t=d)&&((c=e.ref)==null?void 0:c.call(e,d))},r),a.$$contextmenu=d=>d.preventDefault(),u(s,()=>e.icon,o),u(o,()=>e.title),u(n,l(ee,{class:"btn-circle btn-sm",onClick:()=>t==null?void 0:t.close(),get icon(){return l(ot,{size:20})}}),null),u(i,Y(()=>e.children)),u(a,l(T,{get when(){return e.action},get children(){const d=Gn(),c=d.firstChild;return u(c,()=>e.action),d}}),null),_(()=>I(n,M(Wn,"top-0 justify-between"))),r})()};X(["contextmenu"]);const Vn=y('<div><div class="flex items-center justify-between gap-2"><span class="truncate text-left text-sm"></span></div><div class="flex items-center justify-between gap-1"><div></div><div class="text-xs">'),va=e=>{const{proxyLatencyTest:t,proxyLatencyTestingMap:r}=re(),{proxyName:a,isSelected:n,onClick:s}=e,{proxyNodeMap:o}=re(),i=D(()=>o()[a]),d=()=>{var c,f,p;return sn((c=i())==null?void 0:c.type)?(f=i())!=null&&f.xudp?"xudp":(p=i())!=null&&p.udp?"udp":null:null};return(()=>{const c=Vn(),f=c.firstChild,p=f.firstChild,m=f.nextSibling,v=m.firstChild,w=v.nextSibling;return lt(c,"click",s,!0),Z(c,"title",a),u(p,a),u(f,l(ee,{class:"btn-circle btn-ghost h-auto min-h-0 w-auto",get icon(){return l(it,{size:20,get class(){return M(r()[a]&&"animate-pulse text-success")}})},onClick:b=>{b.stopPropagation(),t(a,i().provider)}}),null),u(v,()=>{var b;return nn((b=i())==null?void 0:b.type)},null),u(v,l(T,{get when(){return d()},get children(){return` :: ${d()}`}}),null),u(w,l(zn,{get name(){return e.proxyName}})),_(b=>{const h=M("card card-bordered tooltip-bottom flex flex-col gap-1 border-neutral-focus bg-neutral p-2 text-neutral-content shadow-lg",n&&"border-primary bg-primary-content text-primary",s&&"cursor-pointer"),L=M("truncate text-xs text-slate-500",n&&"text-primary");return h!==b._v$&&I(c,b._v$=h),L!==b._v$2&&I(v,b._v$2=L),b},{_v$:void 0,_v$2:void 0}),c})()};X(["click"]);const Xn=y('<div class="flex flex-col gap-4"><div class="form-control w-2/4 self-center"><label for="url-name"></label><input id="url-name" type="text" name="name" class="input input-bordered min-w-0 "></div><div class="form-control w-2/4 self-center"><label for="url-input">url</label><input id="url-input" type="text" name="url" class="input input-bordered "></div><div class="form-control w-2/4 self-center"><label for="interval"></label><input id="interval" type="text" name="inetrval" class="input input-bordered">'),Zn=y('<div class="flex flex-col gap-4"><div class="form-control w-2/4 self-center"><label for="url-name"></label><input id="url-name" type="text" name="name" class="input input-bordered min-w-0 "></div><div class="mx-auto flex w-2/4 flex-row gap-4"><input id="file_upload" type="file" class="file-input file-input-bordered file-input-primary w-full"></div><div class="mx-auto my-2 w-2/4">'),Jn=y('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div></div><div class="flex flex-col gap-2"><div class="mx-auto my-8 w-2/4">'),Qn=y("<button><span>"),En=e=>{const[t]=W(),[r,a]=g(""),n=o=>{const i=o.currentTarget.value,d=r();isNaN(i)?(a(""),a(d)):(a(i),H("interval",Number(i)))},s=o=>{if(o!==void 0){const i=o/6e4;return Math.ceil(i).toString()}return""};return de(()=>{if(e.interval!=null){const o=s(e.interval);a(o)}}),(()=>{const o=Xn(),i=o.firstChild,d=i.firstChild,c=d.nextSibling,f=i.nextSibling,p=f.firstChild,m=p.nextSibling,v=f.nextSibling,w=v.firstChild,b=w.nextSibling;return u(d,()=>t("name")),c.$$input=h=>{H("name",h.currentTarget.value)},m.$$input=h=>{H("source",h.currentTarget.value)},u(w,()=>t("interval")),b.$$input=n,b.addEventListener("focus",()=>{r()=="0"&&a("")}),b.$$click=()=>{r()=="0"&&a("")},_(()=>Z(m,"placeholder",e.source==""||e.source==null?t("onlyHttpContent"):"")),_(()=>c.value=e.name),_(()=>m.value=e.source),_(()=>b.value=r()=="0"?t("disabled"):r()),o})()},Kn=e=>{const[t]=W(),r=n=>{if(n.target.files){const s=n.target.files[0],o=new FileReader;o.onload=i=>{var c;const d=(c=i.target)==null?void 0:c.result;typeof d=="string"&&H("payload",d)},o.readAsText(s)}},a=()=>{if(e.payload!==void 0){const n=new Blob([e.payload],{type:"text/plain"}),s=URL.createObjectURL(n),o=document.createElement("a");o.href=s,o.download="profile.yaml",o.click()}};return(()=>{const n=Zn(),s=n.firstChild,o=s.firstChild,i=o.nextSibling,d=s.nextSibling,c=d.firstChild,f=d.nextSibling;return u(o,()=>t("name")),i.$$input=p=>{H("name",p.currentTarget.value)},c.addEventListener("change",p=>{r(p)}),u(f,l(T,{get when(){return e.type===P.File},get children(){return l(ee,{type:"button",class:"btn-primary w-full",onClick:()=>a(),get children(){return t("downloadProfile")}})}})),_(()=>i.value=e.name),n})()},Yn=()=>{const[e]=W(),[t]=ct(en),r=()=>[{type:P.Url,name:e("profileURL")},{type:P.File,name:e("profileFile")}];F(()=>{const n=t();if(n&&n.payload!==void 0){const s=tn(n.payload);Re({...n,payload:s})}});const a=async()=>{const n=Cn();try{(await n.put("primitive",{headers:{"Content-Type":"application/json"},json:S()})).ok&&le.success(e("profileSuccess"))}catch(s){console.error(s.message)}};return(()=>{const n=Jn(),s=n.firstChild,o=s.firstChild,i=s.nextSibling,d=i.firstChild;return u(o,l(Q,{get each(){return r()},children:c=>(()=>{const f=Qn(),p=f.firstChild;return f.$$click=()=>{H("pType",c.type)},u(p,()=>c.name),_(m=>{var b,h,L;const v=M(((b=S())==null?void 0:b.pType)===c.type&&"tab-active","tab tab-sm gap-2 px-2 sm:tab-md"),w=((h=t())==null?void 0:h.pType)===P.File||((L=t())==null?void 0:L.pType)===P.Url;return v!==m._v$&&I(f,m._v$=v),w!==m._v$2&&(f.disabled=m._v$2=w),m},{_v$:void 0,_v$2:void 0}),f})()})),u(i,l(T,{get when(){return S().pType===P.Url||S().pType===P.AddNew},get children(){return[l(fe,{withDivider:!0,get children(){return e("profileURL")}}),l(En,{get name(){return S().name},get source(){return S().source},get interval(){return S().interval}})]}}),d),u(i,l(T,{get when(){return S().pType===P.File||S().pType===P.AddNew},get children(){return[l(fe,{withDivider:!0,get children(){return e("profileFile")}}),l(Kn,{get name(){return S().name},get type(){return S().pType},get payload(){return S().payload}})]}}),d),u(d,l(ee,{type:"button",class:"btn-primary w-full",onClick:()=>a(),get disabled(){return S().pType===P.AddNew},get children(){return e("submit")}})),n})()};X(["input","click"]);const es=y('<div class="stat flex-1 place-items-center"><div class="stat-title text-primary-content"></div><div class="stat-value text-2xl text-primary-content lg:text-3xl">'),ts=y('<div class="flex flex-col gap-2"><div class="stats stats-vertical w-full grid-cols-2 bg-primary shadow lg:stats-horizontal lg:flex"></div><div class="rounded-box flex flex-col gap-2 bg-base-300 py-4 lg:flex-row"><div class="flex-1"></div><div class="flex-1">'),z=e=>(()=>{const t=es(),r=t.firstChild,a=r.nextSibling;return u(r,()=>e.label),u(a,Y(()=>e.children)),t})(),ze=()=>{const[e]=W(),[t,r]=g([]),[a,n]=g([]);dt(()=>{ie(()=>{r(p=>p.slice(-ne)),n(p=>p.slice(-ne))})},60*1e3,setInterval);const s=oe("traffic");F(()=>{const p=s();p&&r(m=>[...m,p])});const o=D(()=>G.merge({title:{text:e("traffic")}},me)),i=D(()=>[{name:e("down"),data:t().map(p=>p.down)},{name:e("up"),data:t().map(p=>p.up)}]),d=oe("memory");F(()=>{var m;const p=(m=d())==null?void 0:m.inuse;p&&n(v=>[...v,p])});const c=D(()=>G.merge({title:{text:e("memory")}},me)),f=D(()=>[{name:e("memory"),data:a()}]);return(()=>{const p=ts(),m=p.firstChild,v=m.nextSibling,w=v.firstChild,b=w.nextSibling;return u(m,l(z,{get label(){return e("upload")},get children(){return[D(()=>{var h;return B(((h=s())==null?void 0:h.up)||0).toString()}),"/s"]}}),null),u(m,l(z,{get label(){return e("download")},get children(){return[D(()=>{var h;return B(((h=s())==null?void 0:h.down)||0).toString()}),"/s"]}}),null),u(m,l(z,{get label(){return e("uploadTotal")},get children(){var h;return B(((h=V())==null?void 0:h.uploadTotal)||0).toString()}}),null),u(m,l(z,{get label(){return e("downloadTotal")},get children(){var h;return B(((h=V())==null?void 0:h.downloadTotal)||0).toString()}}),null),u(m,l(z,{get label(){return e("activeConnections")},get children(){var h,L;return((L=(h=V())==null?void 0:h.connections)==null?void 0:L.length)||0}}),null),u(m,l(z,{get label(){return e("memoryUsage")},get children(){var h;return B(((h=d())==null?void 0:h.inuse)||0).toString()}}),null),u(w,l(pe,{type:"area",get options(){return o()},get series(){return i()}})),u(b,l(pe,{type:"line",get options(){return c()},get series(){return f()}})),p})()},ns=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"})),ss=y("<div>"),as=()=>{const e=oe("connections");return F(()=>Ot(e())),null},rs=()=>(de(async()=>{let e=await Yt();e==null&&(e=P.AddNew),Ln(e)}),(()=>{const e=ss();return u(e,l(T,{get when(){return K()==P.Board},get children(){return[l(T,{get when(){return N()},get children(){return l(as,{})}}),l(ze,{})]}}),null),u(e,l(T,{get when(){return K()!=P.Board},get children(){return l(Yn,{})}}),null),e})()),os=y('<div><div class="flex-1 overflow-y-auto p-2 sm:p-4">'),ls=A(()=>R(()=>import("./Setup-84a19848.js"),["./Setup-84a19848.js","./vendor-5f1229f9.js"],import.meta.url)),is=A(()=>R(()=>Promise.resolve().then(()=>ns),void 0,import.meta.url)),cs=A(()=>R(()=>import("./Connections-959e81a5.js"),["./Connections-959e81a5.js","./vendor-5f1229f9.js","./index-e2183211.js","./global-aebafdec.js"],import.meta.url)),ds=A(()=>R(()=>import("./Logs-2f7364bd.js"),["./Logs-2f7364bd.js","./vendor-5f1229f9.js","./index-e2183211.js"],import.meta.url)),us=A(()=>R(()=>import("./Proxies-5ba234a5.js"),["./Proxies-5ba234a5.js","./vendor-5f1229f9.js","./global-aebafdec.js"],import.meta.url)),ps=A(()=>R(()=>import("./Rules-45f47923.js"),["./Rules-45f47923.js","./vendor-5f1229f9.js","./global-aebafdec.js"],import.meta.url)),gs=A(()=>R(()=>import("./Config-3d210598.js"),["./Config-3d210598.js","./vendor-5f1229f9.js"],import.meta.url)),fs=()=>{const e=ut(),t=pt();return F(()=>{Rt()&&Ae(t()?Bt():zt())}),de(()=>{N()||e(C.Setup)}),l(qt,{get locale(){return It()},get children(){const r=os(),a=r.firstChild;return u(r,l(An,{}),a),u(a,l(gt,{get children(){return[l(T,{get when(){return N()},get children(){return[l(k,{get path(){return C.Transition},component:rs}),l(k,{get path(){return C.Overview},component:is}),l(k,{get path(){return C.Proxies},component:us}),l(k,{get path(){return C.Rules},component:ps}),l(k,{get path(){return C.Conns},component:cs}),l(k,{get path(){return C.Log},component:ds}),l(k,{get path(){return C.Config},component:gs}),l(k,{path:"*",get element(){return l(ft,{get href(){return C.Transition}})}})]}}),l(k,{get path(){return N()?C.Setup:"*"},component:ls})]}})),u(r,l(mt,{position:"bottom-center"}),null),_(n=>{const s=M("relative flex h-screen flex-col overscroll-y-none subpixel-antialiased p-safe",At()?"font-twemoji":"font-no-twemoji"),o=Sn();return s!==n._v$&&I(r,n._v$=s),o!==n._v$2&&Z(r,"data-theme",n._v$2=o),n},{_v$:void 0,_v$2:void 0}),r}})};ht.extend(vt);yt(()=>l(xt,{get source(){return bt()},get children(){return l(fs,{})}}),document.getElementById("root"));export{pa as $,As as A,ee as B,ke as C,zs as D,Hs as E,oe as F,Ts as G,Ps as H,Ws as I,ws as J,Cs as K,Me as L,ha as M,bs as N,Le as O,q as P,Ft as Q,se as R,ve as S,j as T,xs as U,$s as V,ys as W,U as X,zn as Y,re as Z,ga as _,wn as a,hs as a0,va as a1,la as a2,ia as a3,ca as a4,J as a5,It as a6,x as a7,aa as a8,ra as a9,Zs as aa,Ys as ab,Js as ac,ta as ad,Qs as ae,ea as af,Es as ag,na as ah,Ks as ai,sa as aj,C as ak,Dt as al,E as am,_s as an,Rt as ao,Ls as ap,_t as aq,Ds as ar,zt as as,Bt as at,Ss as au,vs as av,At as aw,oa as ax,da as ay,N as az,fa as b,Lt as c,fe as d,$n as e,Ms as f,js as g,Fs as h,ks as i,Gt as j,Vs as k,De as l,Xt as m,Is as n,Ns as o,Xs as p,qs as q,Us as r,ma as s,ua as t,W as u,Os as v,Rs as w,Bs as x,Gs as y,kt as z};
